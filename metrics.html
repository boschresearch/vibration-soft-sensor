

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Metrics &mdash; Template-Python</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="_static/jupyter-sphinx.css" />
      <link rel="stylesheet" type="text/css" href="_static/thebelab.css" />
      <link rel="stylesheet" type="text/css" href="_static/css/custom.css?v=f65bdc5e" />
      <link rel="stylesheet" type="text/css" href="_static/css/fix-rtd-property.css?v=3d3ddd9d" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=34f4cfc2"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="_static/thebelab-helper.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
      <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Homoscedastic Uncertainty" href="homoscedastic_model.html" />
    <link rel="prev" title="Hyperparameter Optimization" href="hyperparameter_optimization.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            softsensor
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">About</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="README.html">vibration-soft-sensor   <!-- omit in toc --></a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="tutorials.html">Tutorials</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Reference</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="reference.html">Data Preprocessing</a></li>
<li class="toctree-l1"><a class="reference internal" href="reference.html#linear-methods">Linear Methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="reference.html#neural-networks">Neural Networks</a></li>
<li class="toctree-l1"><a class="reference internal" href="reference.html#training-methods">Training Methods</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="reference.html#postprocessing">Postprocessing</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Metrics</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#softsensor.metrics.WassersteinDistance"><code class="docutils literal notranslate"><span class="pre">WassersteinDistance</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#softsensor.metrics.WassersteinDistance.data"><code class="docutils literal notranslate"><span class="pre">WassersteinDistance.data</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#softsensor.metrics.WassersteinDistance.weights_u"><code class="docutils literal notranslate"><span class="pre">WassersteinDistance.weights_u</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#softsensor.metrics.WassersteinDistance.sort_data"><code class="docutils literal notranslate"><span class="pre">WassersteinDistance.sort_data()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#softsensor.metrics.WassersteinDistance.weighted_hist"><code class="docutils literal notranslate"><span class="pre">WassersteinDistance.weighted_hist()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#softsensor.metrics.WassersteinDistance.pdf"><code class="docutils literal notranslate"><span class="pre">WassersteinDistance.pdf()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#softsensor.metrics.WassersteinDistance.cdf"><code class="docutils literal notranslate"><span class="pre">WassersteinDistance.cdf()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#softsensor.metrics.WassersteinDistance.inverse_cdf"><code class="docutils literal notranslate"><span class="pre">WassersteinDistance.inverse_cdf()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#softsensor.metrics.WassersteinDistance.wasserstein_distance_p"><code class="docutils literal notranslate"><span class="pre">WassersteinDistance.wasserstein_distance_p()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id0"><code class="docutils literal notranslate"><span class="pre">WassersteinDistance.cdf()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id1"><code class="docutils literal notranslate"><span class="pre">WassersteinDistance.inverse_cdf()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id2"><code class="docutils literal notranslate"><span class="pre">WassersteinDistance.pdf()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id3"><code class="docutils literal notranslate"><span class="pre">WassersteinDistance.sort_data()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id4"><code class="docutils literal notranslate"><span class="pre">WassersteinDistance.wasserstein_distance_p()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#softsensor.metrics.WassersteinDistance.wasserstein_fourier_distance"><code class="docutils literal notranslate"><span class="pre">WassersteinDistance.wasserstein_fourier_distance()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id5"><code class="docutils literal notranslate"><span class="pre">WassersteinDistance.weighted_hist()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#softsensor.metrics.WassersteinDistance.wsf_cdf"><code class="docutils literal notranslate"><span class="pre">WassersteinDistance.wsf_cdf()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#softsensor.metrics.WassersteinDistance.wsf_inverse_cdf"><code class="docutils literal notranslate"><span class="pre">WassersteinDistance.wsf_inverse_cdf()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#softsensor.metrics.WassersteinDistance.wsf_pdf"><code class="docutils literal notranslate"><span class="pre">WassersteinDistance.wsf_pdf()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#softsensor.metrics.compute_quantile_metrics"><code class="docutils literal notranslate"><span class="pre">compute_quantile_metrics()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#softsensor.metrics.crps"><code class="docutils literal notranslate"><span class="pre">crps()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#softsensor.metrics.distance_calc"><code class="docutils literal notranslate"><span class="pre">distance_calc()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#softsensor.metrics.ece"><code class="docutils literal notranslate"><span class="pre">ece()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#softsensor.metrics.heteroscedasticity"><code class="docutils literal notranslate"><span class="pre">heteroscedasticity()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#softsensor.metrics.log_area_error"><code class="docutils literal notranslate"><span class="pre">log_area_error()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#softsensor.metrics.mae"><code class="docutils literal notranslate"><span class="pre">mae()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#softsensor.metrics.mpiw"><code class="docutils literal notranslate"><span class="pre">mpiw()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#softsensor.metrics.nll"><code class="docutils literal notranslate"><span class="pre">nll()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#softsensor.metrics.nll_statistic"><code class="docutils literal notranslate"><span class="pre">nll_statistic()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#softsensor.metrics.pearson"><code class="docutils literal notranslate"><span class="pre">pearson()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#softsensor.metrics.picp"><code class="docutils literal notranslate"><span class="pre">picp()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#softsensor.metrics.quantile_ece"><code class="docutils literal notranslate"><span class="pre">quantile_ece()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#softsensor.metrics.r2"><code class="docutils literal notranslate"><span class="pre">r2()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#softsensor.metrics.rmse"><code class="docutils literal notranslate"><span class="pre">rmse()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#softsensor.metrics.rmv"><code class="docutils literal notranslate"><span class="pre">rmv()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#softsensor.metrics.wf_distribution"><code class="docutils literal notranslate"><span class="pre">wf_distribution</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="homoscedastic_model.html">Homoscedastic Uncertainty</a></li>
<li class="toctree-l2"><a class="reference internal" href="calibration.html">Uncertainty Calibration</a></li>
<li class="toctree-l2"><a class="reference internal" href="eval_tools.html">Evaluation Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="visualization.html">Visualization Methods</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="reference.html#frequency-methods">Frequency Methods</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">softsensor</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="reference.html">Data Preprocessing</a></li>
      <li class="breadcrumb-item active">Metrics</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/metrics.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-softsensor.metrics">
<span id="metrics"></span><h1>Metrics<a class="headerlink" href="#module-softsensor.metrics" title="Link to this heading"></a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="softsensor.metrics.WassersteinDistance">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">softsensor.metrics.</span></span><span class="sig-name descname"><span class="pre">WassersteinDistance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/softsensor/metrics.html#WassersteinDistance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#softsensor.metrics.WassersteinDistance" title="Link to this definition"></a></dt>
<dd><p>WassersteinDistance class to calculate the Wasserstein distance and the wasserstein Fourier distance.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="softsensor.metrics.WassersteinDistance.data">
<span class="sig-name descname"><span class="pre">data</span></span><a class="headerlink" href="#softsensor.metrics.WassersteinDistance.data" title="Link to this definition"></a></dt>
<dd><p>The input data as a pandas DataFrame.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="softsensor.metrics.WassersteinDistance.weights_u">
<span class="sig-name descname"><span class="pre">weights_u</span></span><a class="headerlink" href="#softsensor.metrics.WassersteinDistance.weights_u" title="Link to this definition"></a></dt>
<dd><p>The weights associated with the data as a pandas DataFrame.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="softsensor.metrics.WassersteinDistance.sort_data">
<span class="sig-name descname"><span class="pre">sort_data</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/softsensor/metrics.html#WassersteinDistance.sort_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#softsensor.metrics.WassersteinDistance.sort_data" title="Link to this definition"></a></dt>
<dd><p>Sort the data and weights in ascending order.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="softsensor.metrics.WassersteinDistance.weighted_hist">
<span class="sig-name descname"><span class="pre">weighted_hist</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/softsensor/metrics.html#WassersteinDistance.weighted_hist"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#softsensor.metrics.WassersteinDistance.weighted_hist" title="Link to this definition"></a></dt>
<dd><p>Calculate the weighted histogram of the data.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="softsensor.metrics.WassersteinDistance.pdf">
<span class="sig-name descname"><span class="pre">pdf</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/softsensor/metrics.html#WassersteinDistance.pdf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#softsensor.metrics.WassersteinDistance.pdf" title="Link to this definition"></a></dt>
<dd><p>Calculate the probability density function of the data.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="softsensor.metrics.WassersteinDistance.cdf">
<span class="sig-name descname"><span class="pre">cdf</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/softsensor/metrics.html#WassersteinDistance.cdf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#softsensor.metrics.WassersteinDistance.cdf" title="Link to this definition"></a></dt>
<dd><p>Calculate the cumulative density function of the data.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="softsensor.metrics.WassersteinDistance.inverse_cdf">
<span class="sig-name descname"><span class="pre">inverse_cdf</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/softsensor/metrics.html#WassersteinDistance.inverse_cdf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#softsensor.metrics.WassersteinDistance.inverse_cdf" title="Link to this definition"></a></dt>
<dd><p>Calculate the inverse cumulative density function of the data.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="softsensor.metrics.WassersteinDistance.wasserstein_distance_p">
<span class="sig-name descname"><span class="pre">wasserstein_distance_p</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/softsensor/metrics.html#WassersteinDistance.wasserstein_distance_p"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#softsensor.metrics.WassersteinDistance.wasserstein_distance_p" title="Link to this definition"></a></dt>
<dd><p>Calculate the p-th Wasserstein distance.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id0">
<span class="sig-name descname"><span class="pre">cdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_points</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/softsensor/metrics.html#WassersteinDistance.cdf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id0" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id1">
<span class="sig-name descname"><span class="pre">inverse_cdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_points</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/softsensor/metrics.html#WassersteinDistance.inverse_cdf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id1" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id2">
<span class="sig-name descname"><span class="pre">pdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_points</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/softsensor/metrics.html#WassersteinDistance.pdf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id2" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id3">
<span class="sig-name descname"><span class="pre">sort_data</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/softsensor/metrics.html#WassersteinDistance.sort_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id3" title="Link to this definition"></a></dt>
<dd><p>Sorts the data and weights based on the values in the data.</p>
<p>This method sorts the data and weights along the first axis (rows) based on the values in the data.
It returns the sorted indices, sorted data, and sorted weights.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>A tuple containing:</dt><dd><ul class="simple">
<li><p>sorted_indices (numpy.ndarray): The indices that would sort the data.</p></li>
<li><p>sorted_data (pandas.DataFrame): The data sorted according to the sorted indices.</p></li>
<li><p>sorted_weights (pandas.DataFrame): The weights sorted according to the sorted indices.</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3.13/library/stdtypes.html#tuple" title="(in Python v3.13)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id4">
<span class="sig-name descname"><span class="pre">wasserstein_distance_p</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/softsensor/metrics.html#WassersteinDistance.wasserstein_distance_p"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id4" title="Link to this definition"></a></dt>
<dd><p>Compute the Wasserstein distance (p-th order) based on the inverse cumulative distribution function (CDF).</p>
<p>This method calculates the Wasserstein distance, a measure of the distance between two probability distributions,
using the inverse CDF of the distribution. The distance is computed for a specified order <cite>p</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>p</strong> (<a class="reference external" href="https://docs.python.org/3.13/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>optional</em>) – The order of the Wasserstein distance. Defaults to 1.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The computed Wasserstein distance of order <cite>p</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3.13/library/functions.html#float" title="(in Python v3.13)">float</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="softsensor.metrics.WassersteinDistance.wasserstein_fourier_distance">
<span class="sig-name descname"><span class="pre">wasserstein_fourier_distance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/softsensor/metrics.html#WassersteinDistance.wasserstein_fourier_distance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#softsensor.metrics.WassersteinDistance.wasserstein_fourier_distance" title="Link to this definition"></a></dt>
<dd><p>Compute the Wasserstein Fourier distance for the given data.</p>
<p>This method calculates the Wasserstein Fourier distance by first obtaining
the inverse cumulative distribution function (CDF) using the normalized power spectral density and then computing the distance using the specified metric.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>p</strong> (<a class="reference external" href="https://docs.python.org/3.13/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>optional</em>) – The order of the norm used in the distance calculation.
Defaults to 2.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The computed Wasserstein Fourier distance.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3.13/library/functions.html#float" title="(in Python v3.13)">float</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id5">
<span class="sig-name descname"><span class="pre">weighted_hist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nfft</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2048</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nperseg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2048</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/softsensor/metrics.html#WassersteinDistance.weighted_hist"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id5" title="Link to this definition"></a></dt>
<dd><p>Compute weighted histograms for each column in the data.</p>
<p>This method calculates the weighted histogram for each column in the
dataset using the specified number of bins. The weights for each column
are used to compute the histogram. The resulting histograms are stored
in the <cite>self.hist</cite> attribute, and the corresponding probability
distributions are stored in the <cite>self.distribution</cite> attribute.</p>
<p>Parameters:
bins (int): The number of bins to use for the histogram. Default is 100.</p>
<p>Attributes:
self.hist (dict): A dictionary where keys are column names and values</p>
<blockquote>
<div><p>are tuples containing the histogram values and bin edges.</p>
</div></blockquote>
<dl class="simple">
<dt>self.distribution (dict): A dictionary where keys are column names and</dt><dd><p>values are <cite>rv_histogram</cite> objects representing
the probability distributions of the histograms.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="softsensor.metrics.WassersteinDistance.wsf_cdf">
<span class="sig-name descname"><span class="pre">wsf_cdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_points</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/softsensor/metrics.html#WassersteinDistance.wsf_cdf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#softsensor.metrics.WassersteinDistance.wsf_cdf" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="softsensor.metrics.WassersteinDistance.wsf_inverse_cdf">
<span class="sig-name descname"><span class="pre">wsf_inverse_cdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_points</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/softsensor/metrics.html#WassersteinDistance.wsf_inverse_cdf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#softsensor.metrics.WassersteinDistance.wsf_inverse_cdf" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="softsensor.metrics.WassersteinDistance.wsf_pdf">
<span class="sig-name descname"><span class="pre">wsf_pdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_points</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/softsensor/metrics.html#WassersteinDistance.wsf_pdf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#softsensor.metrics.WassersteinDistance.wsf_pdf" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="softsensor.metrics.compute_quantile_metrics">
<span class="sig-prename descclassname"><span class="pre">softsensor.metrics.</span></span><span class="sig-name descname"><span class="pre">compute_quantile_metrics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_loader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['x']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expected_quantiles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([0.05,</span> <span class="pre">0.1,</span> <span class="pre">0.15,</span> <span class="pre">0.2,</span> <span class="pre">0.25,</span> <span class="pre">0.3,</span> <span class="pre">0.35,</span> <span class="pre">0.4,</span> <span class="pre">0.45,</span> <span class="pre">0.5,</span> <span class="pre">0.55,</span> <span class="pre">0.6,</span> <span class="pre">0.65,</span> <span class="pre">0.7,</span> <span class="pre">0.75,</span> <span class="pre">0.8,</span> <span class="pre">0.85,</span> <span class="pre">0.9,</span> <span class="pre">0.95])</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/softsensor/metrics.html#compute_quantile_metrics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#softsensor.metrics.compute_quantile_metrics" title="Link to this definition"></a></dt>
<dd><p>Compute metrics that are compatible with quantile models</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>QuantileNARX</em>) – Quantile model to evaluate</p></li>
<li><p><strong>test_loader</strong> (<a class="reference external" href="https://docs.python.org/3.13/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em>[</em><em>Dataloader</em><em>]</em>) – Test dataset</p></li>
<li><p><strong>output_names</strong> (<a class="reference external" href="https://docs.python.org/3.13/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3.13/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>]</em><em>, </em><em>optional</em>) – Output sensors to consider. The default is [“x”]</p></li>
<li><p><strong>expected_quantiles</strong> (<a class="reference external" href="https://docs.python.org/3.13/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3.13/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>]</em>) – Quantiles to evaluate
Expected to be of the form [lb0, lb1, …, median, …, ub1, ub0]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>mean_scores</strong></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3.13/library/stdtypes.html#dict" title="(in Python v3.13)">dict</a>[<a class="reference external" href="https://docs.python.org/3.13/library/stdtypes.html#str" title="(in Python v3.13)">str</a>, <a class="reference external" href="https://docs.python.org/3.13/library/functions.html#float" title="(in Python v3.13)">float</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="softsensor.metrics.crps">
<span class="sig-prename descclassname"><span class="pre">softsensor.metrics.</span></span><span class="sig-name descname"><span class="pre">crps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3.13/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a></span></span><a class="reference internal" href="_modules/softsensor/metrics.html#crps"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#softsensor.metrics.crps" title="Link to this definition"></a></dt>
<dd><p>The negatively oriented continuous ranked probability score for Gaussians.</p>
<p>Computes CRPS for held out data (y_true) given predictive uncertainty with mean
(y_pred) and standard-deviation (y_std). Each test point is given equal weight
in the overall score over the test set.</p>
<p>Negatively oriented means a smaller value is more desirable.</p>
<p>Adapted from <a class="reference external" href="https://github.com/uncertainty-toolbox/uncertainty-toolbox">https://github.com/uncertainty-toolbox/uncertainty-toolbox</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mu</strong> (<em>torch.Tensor</em>) – Predicted means</p></li>
<li><p><strong>targets</strong> (<em>torch.Tensor</em>) – Target values</p></li>
<li><p><strong>var</strong> (<em>torch.Tensor</em>) – Predicted variances</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>crps</strong></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3.13/library/functions.html#float" title="(in Python v3.13)">float</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="softsensor.metrics.distance_calc">
<span class="sig-prename descclassname"><span class="pre">softsensor.metrics.</span></span><span class="sig-name descname"><span class="pre">distance_calc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inverse_cdf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/softsensor/metrics.html#distance_calc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#softsensor.metrics.distance_calc" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="softsensor.metrics.ece">
<span class="sig-prename descclassname"><span class="pre">softsensor.metrics.</span></span><span class="sig-name descname"><span class="pre">ece</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quantiles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([0.05,</span> <span class="pre">0.1,</span> <span class="pre">0.15,</span> <span class="pre">0.2,</span> <span class="pre">0.25,</span> <span class="pre">0.3,</span> <span class="pre">0.35,</span> <span class="pre">0.4,</span> <span class="pre">0.45,</span> <span class="pre">0.5,</span> <span class="pre">0.55,</span> <span class="pre">0.6,</span> <span class="pre">0.65,</span> <span class="pre">0.7,</span> <span class="pre">0.75,</span> <span class="pre">0.8,</span> <span class="pre">0.85,</span> <span class="pre">0.9,</span> <span class="pre">0.95])</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/softsensor/metrics.html#ece"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#softsensor.metrics.ece" title="Link to this definition"></a></dt>
<dd><p>Expected Calibration Error (ECE) measures the mean absolute calibration error of multiple PICPs</p>
<p>See “Accurate Uncertainties for Deep Learning Using Calibrated Regression”
[Kuleshov et al. 2018 <a class="reference external" href="https://arxiv.org/abs/1807.00263">https://arxiv.org/abs/1807.00263</a>]</p>
<p>See <a class="reference external" href="https://stackoverflow.com/questions/20864847/probability-to-z-score-and-vice-versa">https://stackoverflow.com/questions/20864847/probability-to-z-score-and-vice-versa</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mu</strong> (<em>torch.Tensor</em>) – Predicted means</p></li>
<li><p><strong>targets</strong> (<em>torch.Tensor</em>) – Target values</p></li>
<li><p><strong>var</strong> (<em>torch.Tensor</em>) – Predicted variances</p></li>
<li><p><strong>quantiles</strong> (<a class="reference external" href="https://docs.python.org/3.13/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em>[</em><em>x</em><em>]</em><em>, </em><em>x in</em><em> (</em><em>0</em><em>,</em><em>1</em><em>)</em>) – Quantiles to evaluate</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>pi_width</strong></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="softsensor.metrics.heteroscedasticity">
<span class="sig-prename descclassname"><span class="pre">softsensor.metrics.</span></span><span class="sig-name descname"><span class="pre">heteroscedasticity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/softsensor/metrics.html#heteroscedasticity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#softsensor.metrics.heteroscedasticity" title="Link to this definition"></a></dt>
<dd><p>Heteroscedasticity of uncertainty estimate as std of std</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mu</strong> (<em>torch.Tensor</em>) – Predicted means</p></li>
<li><p><strong>targets</strong> (<em>torch.Tensor</em>) – Target values</p></li>
<li><p><strong>var</strong> (<em>torch.Tensor</em>) – Predicted variances</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>heteroscedasticity</strong></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="softsensor.metrics.log_area_error">
<span class="sig-prename descclassname"><span class="pre">softsensor.metrics.</span></span><span class="sig-name descname"><span class="pre">log_area_error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">psd_original</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">psd_targets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/softsensor/metrics.html#log_area_error"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#softsensor.metrics.log_area_error" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="softsensor.metrics.mae">
<span class="sig-prename descclassname"><span class="pre">softsensor.metrics.</span></span><span class="sig-name descname"><span class="pre">mae</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/softsensor/metrics.html#mae"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#softsensor.metrics.mae" title="Link to this definition"></a></dt>
<dd><p>Mean Absolute Error (MAE)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mu</strong> (<em>torch.Tensor</em>) – Predicted means</p></li>
<li><p><strong>targets</strong> (<em>torch.Tensor</em>) – Target values</p></li>
<li><p><strong>var</strong> (<em>torch.Tensor</em>) – Predicted variances</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>mae</strong></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="softsensor.metrics.mpiw">
<span class="sig-prename descclassname"><span class="pre">softsensor.metrics.</span></span><span class="sig-name descname"><span class="pre">mpiw</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.96</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/softsensor/metrics.html#mpiw"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#softsensor.metrics.mpiw" title="Link to this definition"></a></dt>
<dd><p>Mean Prediction Interval Width (MPIW) measures the width of a specific PI</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mu</strong> (<em>torch.Tensor</em>) – Predicted means</p></li>
<li><p><strong>targets</strong> (<em>torch.Tensor</em>) – Target values</p></li>
<li><p><strong>var</strong> (<em>torch.Tensor</em>) – Predicted variances</p></li>
<li><p><strong>z</strong> (<a class="reference external" href="https://docs.python.org/3.13/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>, </em><em>optional</em>) – Z-score for the specific quantile, the default is 1.96 (95% interval)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>pi_width</strong></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="softsensor.metrics.nll">
<span class="sig-prename descclassname"><span class="pre">softsensor.metrics.</span></span><span class="sig-name descname"><span class="pre">nll</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/softsensor/metrics.html#nll"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#softsensor.metrics.nll" title="Link to this definition"></a></dt>
<dd><p>Gaussian Negative Log Likelihood Loss (NLL)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mu</strong> (<em>torch.Tensor</em>) – Predicted means</p></li>
<li><p><strong>targets</strong> (<em>torch.Tensor</em>) – Target values</p></li>
<li><p><strong>var</strong> (<em>torch.Tensor</em>) – Predicted variances</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>nll</strong></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="softsensor.metrics.nll_statistic">
<span class="sig-prename descclassname"><span class="pre">softsensor.metrics.</span></span><span class="sig-name descname"><span class="pre">nll_statistic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/softsensor/metrics.html#nll_statistic"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#softsensor.metrics.nll_statistic" title="Link to this definition"></a></dt>
<dd><dl class="simple">
<dt>Gaussian Negative Log Likelihood (rather than the score of the optimization objective)</dt><dd><p>We mainly report the NLL loss as its minimization is equivalent to NLL minimization but add this metric for comparability</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mu</strong> (<em>torch.Tensor</em>) – Predicted means</p></li>
<li><p><strong>targets</strong> (<em>torch.Tensor</em>) – Target values</p></li>
<li><p><strong>var</strong> (<em>torch.Tensor</em>) – Predicted variances</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>nll</strong></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="softsensor.metrics.pearson">
<span class="sig-prename descclassname"><span class="pre">softsensor.metrics.</span></span><span class="sig-name descname"><span class="pre">pearson</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/softsensor/metrics.html#pearson"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#softsensor.metrics.pearson" title="Link to this definition"></a></dt>
<dd><p>Pearson correlation coefficient</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mu</strong> (<em>torch.Tensor</em>) – Predicted means</p></li>
<li><p><strong>targets</strong> (<em>torch.Tensor</em>) – Target values</p></li>
<li><p><strong>var</strong> (<em>torch.Tensor</em>) – Predicted variances</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>pearson</strong></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3.13/library/functions.html#float" title="(in Python v3.13)">float</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="softsensor.metrics.picp">
<span class="sig-prename descclassname"><span class="pre">softsensor.metrics.</span></span><span class="sig-name descname"><span class="pre">picp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.96</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/softsensor/metrics.html#picp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#softsensor.metrics.picp" title="Link to this definition"></a></dt>
<dd><p>Prediction Interval Coverage Probability (PICP) measures the coverage of a specific PI</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mu</strong> (<em>torch.Tensor</em>) – Predicted means</p></li>
<li><p><strong>targets</strong> (<em>torch.Tensor</em>) – Target values</p></li>
<li><p><strong>var</strong> (<em>torch.Tensor</em>) – Predicted variances</p></li>
<li><p><strong>z</strong> (<a class="reference external" href="https://docs.python.org/3.13/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>, </em><em>optional</em>) – Z-score for the specific quantile, the default is 1.96 (95% interval)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>pi_coverage</strong></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="softsensor.metrics.quantile_ece">
<span class="sig-prename descclassname"><span class="pre">softsensor.metrics.</span></span><span class="sig-name descname"><span class="pre">quantile_ece</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">predicted_quantiles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expected_quantiles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([0.05,</span> <span class="pre">0.1,</span> <span class="pre">0.15,</span> <span class="pre">0.2,</span> <span class="pre">0.25,</span> <span class="pre">0.3,</span> <span class="pre">0.35,</span> <span class="pre">0.4,</span> <span class="pre">0.45,</span> <span class="pre">0.5,</span> <span class="pre">0.55,</span> <span class="pre">0.6,</span> <span class="pre">0.65,</span> <span class="pre">0.7,</span> <span class="pre">0.75,</span> <span class="pre">0.8,</span> <span class="pre">0.85,</span> <span class="pre">0.9,</span> <span class="pre">0.95])</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/softsensor/metrics.html#quantile_ece"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#softsensor.metrics.quantile_ece" title="Link to this definition"></a></dt>
<dd><p>Expected Calibration Error (ECE) measures the mean absolute calibration error of multiple PICPs</p>
<p>See “Accurate Uncertainties for Deep Learning Using Calibrated Regression”
[Kuleshov et al. 2018 <a class="reference external" href="https://arxiv.org/abs/1807.00263">https://arxiv.org/abs/1807.00263</a>]</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>predicted_quantiles</strong> (<a class="reference external" href="https://docs.python.org/3.13/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em>[</em><em>torch.Tensor</em><em>]</em>) – Expected to be of the form [median, lb0, ub0, lb1, ub1, …]</p></li>
<li><p><strong>targets</strong> (<em>torch.Tensor</em>) – Ground truth for median</p></li>
<li><p><strong>expected_quantiles</strong> (<em>Quantiles to evaluate</em>) – Expected to be of the form [lb0, lb1, …, median, …, ub1, ub0]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>pi_width</strong></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="softsensor.metrics.r2">
<span class="sig-prename descclassname"><span class="pre">softsensor.metrics.</span></span><span class="sig-name descname"><span class="pre">r2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/softsensor/metrics.html#r2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#softsensor.metrics.r2" title="Link to this definition"></a></dt>
<dd><p>R2 score</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mu</strong> (<em>torch.Tensor</em>) – Predicted means</p></li>
<li><p><strong>targets</strong> (<em>torch.Tensor</em>) – Target values</p></li>
<li><p><strong>var</strong> (<em>torch.Tensor</em>) – Predicted variances</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>r2</strong></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3.13/library/functions.html#float" title="(in Python v3.13)">float</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="softsensor.metrics.rmse">
<span class="sig-prename descclassname"><span class="pre">softsensor.metrics.</span></span><span class="sig-name descname"><span class="pre">rmse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/softsensor/metrics.html#rmse"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#softsensor.metrics.rmse" title="Link to this definition"></a></dt>
<dd><p>Root Mean Square Error (RMSE)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mu</strong> (<em>torch.Tensor</em>) – Predicted means</p></li>
<li><p><strong>targets</strong> (<em>torch.Tensor</em>) – Target values</p></li>
<li><p><strong>var</strong> (<em>torch.Tensor</em>) – Predicted variances</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>rmse</strong></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="softsensor.metrics.rmv">
<span class="sig-prename descclassname"><span class="pre">softsensor.metrics.</span></span><span class="sig-name descname"><span class="pre">rmv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/softsensor/metrics.html#rmv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#softsensor.metrics.rmv" title="Link to this definition"></a></dt>
<dd><p>Root Mean Variance (RMV) measures the sharpness of the uncertainty distributions</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mu</strong> (<em>torch.Tensor</em>) – Predicted means</p></li>
<li><p><strong>targets</strong> (<em>torch.Tensor</em>) – Target values</p></li>
<li><p><strong>var</strong> (<em>torch.Tensor</em>) – Predicted variances</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>sharpness</strong></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="softsensor.metrics.wf_distribution">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">softsensor.metrics.</span></span><span class="sig-name descname"><span class="pre">wf_distribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">frequency</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_psd_cumsum</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/softsensor/metrics.html#wf_distribution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#softsensor.metrics.wf_distribution" title="Link to this definition"></a></dt>
<dd></dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="hyperparameter_optimization.html" class="btn btn-neutral float-left" title="Hyperparameter Optimization" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="homoscedastic_model.html" class="btn btn-neutral float-right" title="Homoscedastic Uncertainty" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright Bosch CR.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>